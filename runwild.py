from blackjack import *

def run(deck, deepness = 4):
    '''Run full simulation'''
    _timer = Timer()
    _timer.is_daemon = True
    _timer.start()
    _deck = deck
    record = 0.
    hands = []
    probs = []
    s = float(sum(_deck))
    for c1 in range(10):
        p1 = _deck[c1]
        for c2 in range(10):
            if c1 == c2:
                p2 = p1 - 1
            else:
                p2 = _deck[c2]
            probs.append(p1 * p2)
            hands.append([c1, c2])
    for index in range(len(hands)):
        calc = FastEval(hands[index], _deck, False, deepness) 
        record += calc.ev(calc.cards, calc.deck, evd(score(calc.cards), calc.ddib, 0)) * probs[index]
        _timer.done += 1
    _timer.hastorun = False
    cls()
    # return "Every case evaluated in {}s\nGlobal EV = {}%".format(_timer.count, round(100 * record / (s * (s - 1)), 6)))
    return round(100 * record / (s * (s - 1)), 6)
if __name__ == '__main__':
    print(run([32, 32, 32, 32, 32, 32, 32, 32, 32, 128]))